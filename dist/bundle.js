(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}const i=new class extends class{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}{constructor(){super(...arguments),this.projects=[]}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(JSON.parse(JSON.stringify(this.projects)))}};class l extends e{constructor(){super("project-input","my-form",!0),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:2},i={value:+r,required:!0,min:1,max:500};if(t({value:e,required:!0,minLength:2})&&t(s)&&t(i))return[e,n,+r];alert("some error")}clearInput(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;i.addProject(e,n,r),this.clearInput()}}renderContent(){}configure(){this.element.addEventListener("submit",this.submitHandler)}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],l.prototype,"submitHandler",null);var o=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class a extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("drag ended")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h4").textContent=this.project.title,this.element.querySelector("h5").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}o([n],a.prototype,"dragStartHandler",null),o([n],a.prototype,"dragEndHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");i.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}renderProjects(){document.getElementById(`${this.type}-project-lists`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),i.addListener((e=>{const t=e.filter((e=>"active"==this.type?e.status==r.Active:e.status==r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-lists`;this.element.querySelector("ul").id=e,this.element.querySelector("h3").textContent=this.type.toUpperCase()+" PROJECTS"}}c([n],d.prototype,"dragOverHandler",null),c([n],d.prototype,"dropHandler",null),c([n],d.prototype,"dragLeaveHandler",null),new l,new d("active"),new d("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm9qZWN0cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9wcm9qZWN0cy1kcmFnLWRyb3AvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3Byb2plY3RzLWRyYWctZHJvcC8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovL3Byb2plY3RzLWRyYWctZHJvcC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9wcm9qZWN0cy1kcmFnLWRyb3AvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly9wcm9qZWN0cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3Byb2plY3RzLWRyYWctZHJvcC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly9wcm9qZWN0cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vcHJvamVjdHMtZHJhZy1kcm9wLy4vc3JjL2FwcC50cyJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVJbnB1dCIsImlzVmFsaWQiLCJyZXF1aXJlZCIsInZhbHVlIiwidG9TdHJpbmciLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiYXV0b2JpbmQiLCJfIiwiXzIiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJjb25maWd1cmFibGUiLCJiaW5kIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwicHJvamVjdFN0YXRlIiwibGlzdGVuZXJzIiwibGlzdGVuZXJGbiIsInB1c2giLCJwcm9qZWN0cyIsIm51bU9mUGVvcGxlIiwicHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJBY3RpdmUiLCJ1cGRhdGVMaXN0ZW5lcnMiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJzZWxlY3RlZFByb2plY3QiLCJmaW5kIiwiaXRlbSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsIlByb2plY3RJbnB1dCIsInN1cGVyIiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpdHB0aW9uIiwiZW50ZXJlZFBlb3BsZUFtb3VudCIsInZhbGlkRGVzYyIsInZhbGlkUGVvcGxlIiwiYWxlcnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiZ2F0aGVyVXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiZGVzYyIsImFkZFByb2plY3QiLCJjbGVhcklucHV0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJQcm9qZWN0SXRlbSIsImhvc3RJZCIsInJlbmRlckNvbnRlbnQiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImNvbnNvbGUiLCJsb2ciLCJkcmFnU3RhcnRIYW5kbGVyIiwiZHJhZ0VuZEhhbmRsZXIiLCJ0ZXh0Q29udGVudCIsInBlcnNvbnMiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcmpJZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsIkZpbmlzaGVkIiwicmVtb3ZlIiwiaW5uZXJIVE1MIiwicHJqSXRlbSIsImRyYWdPdmVySGFuZGxlciIsImRyYWdMZWF2ZUhhbmRsZXIiLCJkcm9wSGFuZGxlciIsImFkZExpc3RlbmVyIiwicmVsZXZhbnRQcm9qZWN0cyIsImZpbHRlciIsInByaiIsInJlbmRlclByb2plY3RzIiwibGlzdElkIiwidG9VcHBlckNhc2UiXSwibWFwcGluZ3MiOiJtQkFBTyxNQUFlQSxFQUtwQixZQUFZQyxFQUFvQkMsRUFBdUJDLEVBQXdCQyxHQUM3RUMsS0FBS0MsZ0JBQWtCQyxTQUFTQyxlQUFlUCxHQUMvQ0ksS0FBS0ksWUFBY0YsU0FBU0MsZUFBZU4sR0FFM0MsTUFBTVEsRUFBZUgsU0FBU0ksV0FBV04sS0FBS0MsZ0JBQWdCTSxTQUFTLEdBQ3ZFUCxLQUFLUSxRQUFVSCxFQUFhSSxrQkFDeEJWLElBQWNDLEtBQUtRLFFBQVFFLEdBQUtYLEdBRXBDQyxLQUFLVyxPQUFPYixHQUdOLE9BQU9BLEdBQ2JFLEtBQUtJLFlBQVlRLHNCQUFzQmQsRUFBZ0IsYUFBZSxZQUFhRSxLQUFLUSxVQ1JyRixTQUFTSyxFQUFTQyxHQUN2QixJQUFJQyxHQUFVLEVBc0JkLE9BcEJJRCxFQUFpQkUsV0FDbkJELEVBQVVBLEdBQStELElBQXBERCxFQUFpQkcsTUFBTUMsV0FBV0MsT0FBT0MsUUFHOUIsTUFBOUJOLEVBQWlCTyxXQUF1RCxpQkFBM0JQLEVBQWlCRyxRQUNoRUYsRUFBVUEsR0FBV0QsRUFBaUJHLE1BQU1HLFFBQVVOLEVBQWlCTyxXQUd2QyxNQUE5QlAsRUFBaUJRLFdBQXVELGlCQUEzQlIsRUFBaUJHLFFBQ2hFRixFQUFVQSxHQUFXRCxFQUFpQkcsTUFBTUcsUUFBVU4sRUFBaUJRLFdBRzdDLE1BQXhCUixFQUFpQlMsS0FBaUQsaUJBQTNCVCxFQUFpQkcsUUFDMURG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RCxFQUFjZSxPQUFTZixFQUFjc0UsVUFHaEcsaUJBQWlCNUUsR0FDZjFCLEtBQUtRLFFBQVFvRCxjQUFjLE1BQU9xQyxVQUFVTSxPQUFPLGFBRzdDLGlCQUNLckcsU0FBU0MsZUFBZSxHQUFHSCxLQUFLOEYsc0JBQ3hDVSxVQUFZLEdBQ2YsSUFBSyxNQUFNQyxLQUFXekcsS0FBSytGLGlCQUN6QixJQUFJZCxFQUFZakYsS0FBS1EsUUFBUW9ELGNBQWMsTUFBT2xELEdBQUkrRixHQUkxRCxZQUNFekcsS0FBS1EsUUFBUXVFLGlCQUFpQixXQUFZL0UsS0FBSzBHLGlCQUMvQzFHLEtBQUtRLFFBQVF1RSxpQkFBaUIsWUFBYS9FLEtBQUsyRyxrQkFDaEQzRyxLQUFLUSxRQUFRdUUsaUJBQWlCLE9BQVEvRSxLQUFLNEcsYUFDM0N0RSxFQUFhdUUsYUFBYW5FLElBQ3hCLE1BQU1vRSxFQUFtQnBFLEVBQVNxRSxRQUFRQyxHQUN2QixVQUFiaEgsS0FBSzhGLEtBQXlCa0IsRUFBSTNFLFFBQVVMLEVBQWNlLE9BQ3ZEaUUsRUFBSTNFLFFBQVVMLEVBQWNzRSxXQUVyQ3RHLEtBQUsrRixpQkFBbUJlLEVBQ3hCOUcsS0FBS2lILG9CQUlULGdCQUNFLE1BQU1DLEVBQVMsR0FBR2xILEtBQUs4RixxQkFDdkI5RixLQUFLUSxRQUFRb0QsY0FBYyxNQUFPbEQsR0FBS3dHLEVBQ3ZDbEgsS0FBS1EsUUFBUW9ELGNBQWMsTUFBTytCLFlBQWMzRixLQUFLOEYsS0FBS3FCLGNBQWdCLGFBM0M1RSxHQURDMUYsRyxvQ0FVRCxHQURDQSxHLGdDQU1ELEdBRENBLEcscUNDdkJILElBQUlnQyxFQUNKLElBQUlvQyxFQUFZLFVBQ2hCLElBQUlBLEVBQVksYSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XG4gIHB1YmxpYyB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gIHB1YmxpYyBob3N0RWxlbWVudDogVDtcbiAgcHVibGljIGVsZW1lbnQ6IFU7XG5cbiAgY29uc3RydWN0b3IodGVtcGxhdGVJZDogc3RyaW5nLCBob3N0RWxlbWVudElkOiBzdHJpbmcsIGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sIG5ld0VsZW1lbnRJZD86IHN0cmluZykge1xuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpISBhcyBUO1xuXG4gICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LCB0cnVlKTtcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcbiAgICBpZiAobmV3RWxlbWVudElkKSB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XG5cbiAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXR0YWNoKGluc2VydEF0U3RhcnQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChpbnNlcnRBdFN0YXJ0ID8gXCJhZnRlcmJlZ2luXCIgOiBcImJlZm9yZWVuZFwiLCB0aGlzLmVsZW1lbnQpO1xuICB9XG5cbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcbn1cbiIsImV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xuICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyO1xuICByZXF1aXJlZD86IGJvb2xlYW47XG4gIG1pbkxlbmd0aD86IG51bWJlcjtcbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICBtaW4/OiBudW1iZXI7XG4gIG1heD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKTogYm9vbGVhbiB7XG4gIGxldCBpc1ZhbGlkID0gdHJ1ZTtcblxuICBpZiAodmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlZCkge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICE9PSAwO1xuICB9XG5cbiAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA+PSB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aDtcbiAgfVxuXG4gIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPD0gdmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGg7XG4gIH1cblxuICBpZiAodmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPj0gdmFsaWRhdGFibGVJbnB1dC5taW47XG4gIH1cblxuICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPD0gdmFsaWRhdGFibGVJbnB1dC5tYXg7XG4gIH1cblxuICByZXR1cm4gaXNWYWxpZDtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBhdXRvYmluZChfOiBhbnksIF8yOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gIGNvbnN0IGFkakRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgZ2V0KCkge1xuICAgICAgY29uc3QgYm91bmRGbiA9IG9yaWdpbmFsTWV0aG9kLmJpbmQodGhpcyk7XG4gICAgICByZXR1cm4gYm91bmRGbjtcbiAgICB9LFxuICB9O1xuXG4gIHJldHVybiBhZGpEZXNjcmlwdG9yO1xufVxuIiwiZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XG4gIEFjdGl2ZSxcbiAgRmluaXNoZWQsXG59XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgY29uc3RydWN0b3IocHVibGljIGlkOiBzdHJpbmcsIHB1YmxpYyB0aXRsZTogc3RyaW5nLCBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZywgcHVibGljIHBlb3BsZTogbnVtYmVyLCBwdWJsaWMgc3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7fVxufVxuIiwiaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XG5cbmNsYXNzIFN0YXRlPFQ+IHtcbiAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdO1xuXG4gIGFkZExpc3RlbmVyKGxpc3RlbmVyRm46IExpc3RlbmVyPFQ+KSB7XG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD4ge1xuICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcblxuICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIG51bU9mUGVvcGxlOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBwcm9qZWN0ID0gbmV3IFByb2plY3QoTWF0aC5yYW5kb20oKS50b1N0cmluZygpLCB0aXRsZSwgZGVzY3JpcHRpb24sIG51bU9mUGVvcGxlLCBQcm9qZWN0U3RhdHVzLkFjdGl2ZSk7XG5cbiAgICB0aGlzLnByb2plY3RzLnB1c2gocHJvamVjdCk7XG5cbiAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xuICB9XG5cbiAgbW92ZVByb2plY3QocHJvamVjdElkOiBzdHJpbmcsIG5ld1N0YXR1czogUHJvamVjdFN0YXR1cykge1xuICAgIGNvbnN0IHNlbGVjdGVkUHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gcHJvamVjdElkKTtcblxuICAgIGlmIChzZWxlY3RlZFByb2plY3QgJiYgc2VsZWN0ZWRQcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XG4gICAgICBzZWxlY3RlZFByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzO1xuXG4gICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xuICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xuICAgICAgbGlzdGVuZXJGbihKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMucHJvamVjdHMpKSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBuZXcgUHJvamVjdFN0YXRlKCk7XG4iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xuaW1wb3J0IHsgVmFsaWRhdGFibGUsIHZhbGlkYXRlIH0gZnJvbSBcIi4uL3V0aWwvdmFsaWRhdGlvblwiO1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XG4gIHB1YmxpYyB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcbiAgcHVibGljIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBwdWJsaWMgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcInByb2plY3QtaW5wdXRcIiwgXCJteS1mb3JtXCIsIHRydWUpO1xuXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI3RpdGxlXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2Rlc2NyaXB0aW9uXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNwZW9wbGVcIikgYXMgSFRNTElucHV0RWxlbWVudDtcblxuICAgIHRoaXMuY29uZmlndXJlKCk7XG4gIH1cblxuICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcbiAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIGNvbnN0IGVudGVyZWREZXNjcml0cHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xuICAgIGNvbnN0IGVudGVyZWRQZW9wbGVBbW91bnQgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcblxuICAgIGNvbnN0IHZhbGlkVGl0bGU6IFZhbGlkYXRhYmxlID0geyB2YWx1ZTogZW50ZXJlZFRpdGxlLCByZXF1aXJlZDogdHJ1ZSwgbWluTGVuZ3RoOiAyIH07XG4gICAgY29uc3QgdmFsaWREZXNjOiBWYWxpZGF0YWJsZSA9IHsgdmFsdWU6IGVudGVyZWREZXNjcml0cHRpb24sIHJlcXVpcmVkOiB0cnVlLCBtaW5MZW5ndGg6IDIgfTtcbiAgICBjb25zdCB2YWxpZFBlb3BsZTogVmFsaWRhdGFibGUgPSB7IHZhbHVlOiArZW50ZXJlZFBlb3BsZUFtb3VudCwgcmVxdWlyZWQ6IHRydWUsIG1pbjogMSwgbWF4OiA1MDAgfTtcblxuICAgIGlmICghdmFsaWRhdGUodmFsaWRUaXRsZSkgfHwgIXZhbGlkYXRlKHZhbGlkRGVzYykgfHwgIXZhbGlkYXRlKHZhbGlkUGVvcGxlKSkge1xuICAgICAgYWxlcnQoXCJzb21lIGVycm9yXCIpO1xuICAgIH0gZWxzZSByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2NyaXRwdGlvbiwgK2VudGVyZWRQZW9wbGVBbW91bnRdO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhcklucHV0KCk6IHZvaWQge1xuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSBcIlwiO1xuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gXCJcIjtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dCgpO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcbiAgICAgIGNvbnN0IFt0aXRsZSwgZGVzYywgcGVvcGxlXSA9IHVzZXJJbnB1dDtcbiAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xuICAgICAgdGhpcy5jbGVhcklucHV0KCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyQ29udGVudCgpIHt9XG5cbiAgY29uZmlndXJlKCkge1xuICAgIC8vdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5zdWJtaXRIYW5kbGVyLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuc3VibWl0SGFuZGxlcik7XG4gIH1cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tIFwiLi4vbW9kZWxzL2RyYWctZHJvcFwiO1xuaW1wb3J0IHsgYXV0b2JpbmQgfSBmcm9tIFwiLi4vZGVjb3JhdG9ycy9hdXRvYmluZFwiO1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD4gaW1wbGVtZW50cyBEcmFnZ2FibGUge1xuICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XG5cbiAgZ2V0IHBlcnNvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEgPyBcIjEgcGVyc29uXCIgOiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XG4gICAgc3VwZXIoXCJzaW5nbGUtcHJvamVjdFwiLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xuXG4gICAgdGhpcy5jb25maWd1cmUoKTtcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRoaXMucHJvamVjdC5pZCk7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XG4gIH1cbiAgQGF1dG9iaW5kXG4gIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCkge1xuICAgIGNvbnNvbGUubG9nKFwiZHJhZyBlbmRlZFwiKTtcbiAgfVxuXG4gIGNvbmZpZ3VyZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdzdGFydFwiLCB0aGlzLmRyYWdTdGFydEhhbmRsZXIpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VuZFwiLCB0aGlzLmRyYWdFbmRIYW5kbGVyKTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoNFwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJoNVwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnMgKyBcIiBhc3NpZ25lZFwiO1xuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwicFwiKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XG4gIH1cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL2Jhc2UtY29tcG9uZW50XCI7XG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSBcIi4uL2RlY29yYXRvcnMvYXV0b2JpbmRcIjtcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlXCI7XG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xuaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xuXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xuICBwdWJsaWMgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdID0gW107XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiBcImFjdGl2ZVwiIHwgXCJmaW5pc2hlZFwiKSB7XG4gICAgc3VwZXIoXCJwcm9qZWN0LWxpc3RcIiwgXCJhcHBcIiwgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCk7XG4gICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XG5cbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIGRyYWdPdmVySGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmRhdGFUcmFuc2ZlciEgJiYgZXZlbnQuZGF0YVRyYW5zZmVyIS50eXBlc1swXSA9PT0gXCJ0ZXh0L3BsYWluXCIpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpITtcbiAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwiZHJvcHBhYmxlXCIpO1xuICAgIH1cbiAgfVxuXG4gIEBhdXRvYmluZFxuICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgY29uc3QgcHJqSWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoXCJ0ZXh0L3BsYWluXCIpO1xuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcmpJZCwgdGhpcy50eXBlID09PSBcImFjdGl2ZVwiID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkKTtcbiAgfVxuICBAYXV0b2JpbmRcbiAgZHJhZ0xlYXZlSGFuZGxlcihfOiBEcmFnRXZlbnQpIHtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpIS5jbGFzc0xpc3QucmVtb3ZlKFwiZHJvcHBhYmxlXCIpO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0cygpIHtcbiAgICBjb25zdCBlTCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RoaXMudHlwZX0tcHJvamVjdC1saXN0c2ApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xuICAgIGVMLmlubmVySFRNTCA9IFwiXCI7XG4gICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xuICAgICAgbmV3IFByb2plY3RJdGVtKHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwidWxcIikhLmlkLCBwcmpJdGVtKTtcbiAgICB9XG4gIH1cblxuICBjb25maWd1cmUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnbGVhdmVcIiwgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgdGhpcy5kcm9wSGFuZGxlcik7XG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XG4gICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKChwcmo6IFByb2plY3QpID0+IHtcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PSBcImFjdGl2ZVwiKSByZXR1cm4gcHJqLnN0YXR1cyA9PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcbiAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT0gUHJvamVjdFN0YXR1cy5GaW5pc2hlZDtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0cztcbiAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlckNvbnRlbnQoKSB7XG4gICAgY29uc3QgbGlzdElkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0LWxpc3RzYDtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcInVsXCIpIS5pZCA9IGxpc3RJZDtcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcImgzXCIpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgXCIgUFJPSkVDVFNcIjtcbiAgfVxuXG4gIC8vIHByaXZhdGUgYXR0YWNoKCkge1xuICAvLyAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFwiYmVmb3JlZW5kXCIsIHRoaXMuZWxlbWVudCk7XG4gIC8vIH1cbn1cbiIsIi8vIDxyZWZlcmVuY2UgcGF0aD1cIm1vZGVscy9kcmFnLWRyb3AudHNcIiAvPlxuLy8gPHJlZmVyZW5jZSBwYXRoPVwibW9kZWxzL3Byb2plY3QudHNcIiAvPlxuLy8gPHJlZmVyZW5jZSBwYXRoPVwic3RhdGUvcHJvamVjdC1zdGF0ZS50c1wiIC8+XG4vLyA8cmVmZXJlbmNlIHBhdGg9XCJ1dGlsL3ZhbGlkYXRpb24udHNcIiAvPlxuLy8gPHJlZmVyZW5jZSBwYXRoPVwiZGVjb3JhdG9ycy9hdXRvYmluZC50c1wiIC8+XG4vLyA8cmVmZXJlbmNlIHBhdGg9XCJjb21wb25lbnRzL3Byb2plY3QtbGlzdC50c1wiIC8+XG4vLyA8cmVmZXJlbmNlIHBhdGg9XCJjb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHNcIiAvPlxuaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSBcIi4vY29tcG9uZW50cy9wcm9qZWN0LWlucHV0XCI7XG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XG5cbm5ldyBQcm9qZWN0SW5wdXQoKTtcbm5ldyBQcm9qZWN0TGlzdChcImFjdGl2ZVwiKTtcbm5ldyBQcm9qZWN0TGlzdChcImZpbmlzaGVkXCIpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==